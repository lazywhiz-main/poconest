# グラウンデッド・セオリー 仮説生成ロジック解説

## 🔍 **仮説生成での情報利用階層**

### **レベル1: カードの中身（最重要 - 70%）**
グラウンデッド・セオリーのオープンコーディングでは、カードの内容が最も重要な情報源となります。

```typescript
// カード内容の抽出
const textContent = cluster.cards
  .map(card => `${card.title || ''} ${card.content || ''}`)
  .join(' ');

// AI概念抽出時にカード内容を直接送信
await supabase.functions.invoke('grounded-theory-analysis', {
  body: {
    textContent,      // ← カードのタイトル・内容
    clusterName,      // ← ラベル
  }
});
```

**役割**:
- 具体的な概念・現象の抽出源
- 関係性発見の根拠データ
- 仮説の具体性と説得力を決定

### **レベル2: カード間の関係性（20%）**
クラスター内およびクラスター間の実際の関連性

**役割**:
- 概念間の相互作用パターン
- 因果関係の発見
- 複合的価値創造メカニズムの特定

### **レベル3: クラスターラベル（10% - 方向性決定）**
概念の方向性と文脈を提供

**役割**:
- 概念の**カテゴリ分類**の指針
- 関係性の**文脈理解**
- 仮説の**テーマ設定**

## 🧠 **実際の処理フロー**

### **Phase 1: オープンコーディング（概念抽出）**
```
【入力】
├── カード内容: "宇都宮大学の学生が地域のグルメ体験で新しい発見と楽しさを感じた。
│               参加型の食イベントが地域住民との交流を生み出し..."
└── ラベル: "宇都宮・宇都宮大学"

【AI処理】
├── カード内容から → 「大学連携」「体験価値」「参加型体験」概念抽出
└── ラベルから → 「地域性」「教育機関」文脈理解

【結果】
抽出概念: 地域連携、体験価値、学生参加、エンターテーメント性、学習効果
```

### **Phase 2: 軸足コーディング（関係性分析）**
```
【概念間の関係性発見】
├── カード内容の共起分析 → "体験" + "学生" + "地域" + "楽しい"
├── 語彙類似度計算 → 「体験価値」↔「エンターテーメント性」(類似度: 0.73)
└── ラベル間の意味関係 → "宇都宮" ↔ "エンターテーメント"

【パラダイムモデル構築】
現象: 地域×教育機関の体験価値創造
原因条件: 学生参加、地域資源活用
文脈: 大学と地域の連携環境
戦略: 参加型体験イベント
結果: エンターテーメント性、学習効果、地域活性化
```

### **Phase 3: 選択的コーディング（仮説生成）**
```
【生成された仮説】
"食体験のエンターテーメント性は、複数の相互関連する要因によって特徴づけられる複合的現象である"

【根拠の構造】
├── カード内容: 
│   ├── 具体的な体験記述: "学生が餃子の手作り体験で..."
│   ├── 感情的反応: "新しい発見と楽しさを感じた"
│   └── 効果の観察: "地域住民との交流を生み出し"
└── ラベル:
    ├── クラスター間の概念的関係性: "宇都宮" ↔ "エンターテーメント"
    └── テーマの一貫性: 地域性 + 教育 + 体験価値
```

## 📊 **品質比較例**

### **🎯 高品質な仮説生成の条件**

#### **カード内容が豊富な場合**
```
【カード例】
"宇都宮大学生が地域の餃子店で手作り体験を行い、店主との対話を通じて
地域の歴史や文化を学んだ。参加者は『ただ食べるだけでなく、作る過程や
背景を知ることで、食べ物への愛着が深まった』と感想を述べ、
地域住民も『若い人との交流が新鮮で楽しい』と好評価。"

【生成される仮説】
"地域×教育×体験の三位一体が参加者エンゲージメントと学習効果を
同時に生み出す複合的価値創造メカニズムであり、単純な消費体験を
超えた文化的・社会的価値を創出する"

【根拠の豊富さ】
- 具体的行動: 手作り体験、対話
- 感情的反応: 愛着、楽しさ
- 学習効果: 歴史・文化の理解
- 社会的効果: 世代間交流
```

#### **カード内容が薄い場合**
```
【カード例】
"宇都宮, 大学, 食べ物"

【生成される仮説】
"地域と大学の連携が何らかの効果を生む"

【問題点】
- 抽象的で説得力に欠ける
- 具体的根拠が不足
- 検証可能性が低い
```

## 🎯 **クラスターラベルの影響**

### **ラベルが仮説品質に与える影響**

#### **1. 概念カテゴリ分類への影響**
```
❌ 悪いラベル: "cluster_1", "group_a"
→ 概念の方向性が不明
→ 無意味な分類

✅ 良いラベル: "地域ブランド・大学連携", "体験価値・エンターテーメント"
→ 明確な概念方向
→ 意味のあるカテゴリ分類
```

#### **2. 関係性推論への影響**
```
ラベル間の語彙類似度が関係性発見の手がかりとなる

例: "宇都宮・大学連携" ↔ "体験価値・エンターテーメント"
→ 地域教育と体験価値の関係性を示唆
→ より具体的な関係性パターンの発見
```

#### **3. 仮説文生成への影響**
```
AIがラベルを文脈として仮説の方向性を決定

良いラベル → "食体験のエンターテーメント性が地域と教育機関の連携によって..."
悪いラベル → "グループ1とグループ2の関係が..."
```

## 🏆 **最適化のポイント**

### **重要度ランキング**
1. **カード内容の質** (70%)
   - 具体的な体験記述
   - 感情的反応の記録
   - 効果・影響の観察
   - 文脈情報の豊富さ

2. **カード間の関係性** (20%)
   - 実際の関連性パターン
   - 相互作用の複雑さ
   - 因果関係の明確さ

3. **ラベルの品質** (10%)
   - 意味的な明確性
   - 概念の方向性
   - 関係性の示唆

### **品質向上戦略**
1. **カード作成時**: 具体的な体験、感情、効果を詳細に記録
2. **ラベリング時**: 意味のある、関係性を示唆する命名
3. **関係性構築時**: 実際の相互作用パターンに基づく関係性設定

## 🔬 **技術実装詳細**

### **テキスト前処理**
```typescript
// カード内容のクリーニング
const cleanedText = this.cleanTextForConceptExtraction(textContent);
// 話者ラベル、構造マーカー、時間表記の除去
```

### **AI概念抽出**
```typescript
// Edge Function経由でのAI概念抽出
const concepts = await this.extractConceptsWithAI(textContent, clusterName);
// GPT/Geminiによる高度な概念理解
```

### **統計的補完**
```typescript
// 統計的手法による概念抽出
const statisticalConcepts = this.extractConceptsStatistically(textContent);
// 頻度分析、共起分析による補完
```

## 📈 **今後の改善方向**

1. **カード品質向上**: テンプレート化、ガイドライン提供
2. **ラベリング支援**: AI支援ラベル生成、品質評価
3. **関係性学習**: ユーザーフィードバックによる関係性パターン学習
4. **仮説検証**: 生成された仮説の実証研究支援機能

---

**結論**: カードの中身が仮説の**具体性と説得力**を決定し、ラベルが**方向性と一貫性**を提供する相補関係。「食体験のエンターテーメント性」のような説得力のある仮説は、豊富なカード内容と適切なラベルの両方があってこそ生まれる。

---
*作成日: 2024年12月27日*
*作成者: AI Assistant*
